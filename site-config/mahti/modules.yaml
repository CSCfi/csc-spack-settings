modules:
  enable::
    - lmod
  lmod:
    hash_length: 0
    core_compilers:
      - gcc@4.8.5
      - gcc@7.5.0
    hierarchy:
      - mpi
    whitelist:
      - amdblis
      - 'darshan-runtime%gcc@9.3.0'
      - 'darshan-util%gcc@9.3.0'
      - amdscalapack
      - amdfftw
      - 'bzip2%gcc@6.0.0:'
      - blitz
      - 'gcc@9.3.0'
      - 'gcc@7.4.0'
      - cdo
      - clang
      - cp2k
      - 'curl%gcc@4.8.5'
      - eccodes
      - emacs
      - extrae
      - 'fftw%gcc@6.0.0:'
      - git
      - git-lfs
      - 'gnuplot+X'
      - go
      - gromacs
      - grib-api
      - 'hdf5%gcc@6.0.0:'
      - 'hdf5%intel@19.1.1'
      - htop
      - openmpi
      - slepc
      - openblas
      - papi
      - hpcx-mpi
      - mariadb
      - mpip
      - mumps
      - 'mc%gcc@4.8.5'
      - nano
      - 'numactl%gcc@4.8.5'
      - mg
      - mpich
      - intel-mkl
      - intel-mpi
      - jemalloc
      - jasper
      - petsc
      - parallel-netcdf
      - 'p7zip%gcc@4.8.5'
      - pigz
      - netlib-scalapack
      - vim
      - 'gsl%gcc@6.0.0:'
      - 'netcdf%gcc@6.0.0:'
      - netcdf-fortran
      - netcdf-c
      - 'metis~int64'
      - 'patchelf%gcc@4.8.5'
      - pdsh
      - 'perl%gcc@4.8.5'
      - openfoam-org
      - 'boost +atomic+chrono~clanglibcpp+context+coroutine cxxstd=14 +date_time~debug+exception+fiber+filesystem+graph+icu+iostreams+locale+log+math~mpi+multithreaded~numpy~pic+program_options~python+random+regex+serialization+shared+signals~singlethreaded+system~taggedlayout+test+thread+timer~versionedlayout visibility=hidden +wave'
      - 'boost@1.68.0+atomic+chrono~clanglibcpp~context~coroutine cxxstd=98 +date_time~debug+exception~fiber+filesystem+graph~icu+iostreams+locale+log+math+mpi+multithreaded~numpy~pic+program_options~python+random+regex+serialization+shared+signals~singlethreaded+system~taggedlayout+test+thread+timer~versionedlayout visibility=hidden +wave'
      - parallel-netcdf
      - hpl
      - openjdk
      - namd
      - 'cmake%gcc@4.8.5'
      - 'llvm%gcc@4.8.5'
      - 'intel%gcc@4.8.5'
      - 'valgrind%gcc@4.8.5'
      - 'rsync%gcc@4.8.5'
      - scalasca
      - scorep
      - spindle
      - subversion
      - tmux
      - zstd
      - nccl
      - amdlibflame
      - amdblis
      - hypre
      - zoltan
      - gsl
      - flux-core
      - flux-sched
      - tau
    blacklist:
      - '%clang@10.0.0'
      - '%gcc@4.8.5'
      - '%gcc@7.4.0'
      - '%gcc@7.5.0'
      - '%gcc@8.3.0'
      - '%gcc@9.3.0'
      - '%intel@19.0.4'
      - '%intel@19.1.1'
      - '%intel@18.0.5'
    all:
      conflict:
        - '${PACKAGE}'
      environment:
        set:
          ${PACKAGE}_INSTALL_ROOT: ${PREFIX}
    amdscalapack:
      suffixes:
        "^amdblis threads=openmp": omp
    amdfftw:
      suffixes:
        "+mpi": mpi
        "+openmp": omp
    tau:
      suffixes:
        "+mpi": mpi
        "+openmp": omp
        "+pdt": pdt
    netlib-scalapack:
      suffixes:
        "^openblas threads=openmp": omp
    mumps:
      suffixes:
        "^openblas thread=openmp": omp
    hpl:
      suffixes:
        "+openmp": omp
    gcc:
      environment:
        set:
          CC: gcc
          CXX: g++
          FC: gfortran
          F90: gfortran
          F77: gfortran
          I_MPI_CC: gcc
          I_MPI_CXX: g++
          I_MPI_FC: gfortran
          I_MPI_F90: gfortran
          I_MPI_F77: gfortran
    intel:
      environment:
        set:
          CC: icc
          CXX: icpc
          FC: ifort
          F90: ifort
          F77: ifort
          ICCCFG: /appl/opt/intel_configs/icc_gcc93_csc.cfg
          ICPCCFG : /appl/opt/intel_configs/icpc_gcc93_csc.cfg
          IFORTCFG : /appl/opt/intel_configs/ifort_gcc93_csc.cfg
          I_MPI_CC: icc
          I_MPI_CXX: icpc
          I_MPI_FC: ifort
          I_MPI_F90: ifort
          I_MPI_F77: ifort
    openmpi:
      environment:
        set:
          SLURM_MPI_TYPE: pmix_v3
          OMPI_MCA_coll_hcoll_enable: "0"
    fftw:
      suffixes:
        "+mpi": mpi
        "+openmp": omp
    boost:
      suffixes:
        "+mpi": mpi
    netcdf-c:
      suffixes:
        "+mpi": mpi
    gromacs:
      suffixes:
        "+plumed": plumed
    hdf5:
      suffixes:
        "+mpi": mpi
    petsc:
      suffixes:
        "+complex+double": cmplx
        "+int64": int64
    intel-mkl:
      suffixes:
        "intel-mkl threads=openmp": omp
    openblas:
      suffixes:
        "threads=openmp": omp
    amdlibflame:
      suffixes:
        "threads=openmp": omp
    amdblis:
      suffixes:
        "threads=openmp": omp
    cp2k:
      suffixes:
        "+openmp": omp
